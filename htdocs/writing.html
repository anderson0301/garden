<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>執筆用 | ●●● | マイホームブログ | Web屋の芝生DIY</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/shared/css/basic.css" media="all"></head><body class="lyt-main-sub turf"><div id="content"><main><div id="main-inner"><p class="main-visual"><img src="/wp-content/uploads/thum-turf.jpg" alt=""></p>


<!--======================================ここから記事用ソース======================================-->


<p>ローカルサーバを立てる際、WindowsではXAMPP、MacではMAMPを使うのがわりとセオリーだと思います。しかし、最近のMacにはApacheが最初から入っているので、実はMAMPなどのツールは必要なく、既存ファイルの設定をゴニョゴニョいじることでローカルサーバを複数立てることが可能です。本記事ではMAMPを使わずに、Macで複数のローカルサーバを立てる手順をご紹介させていただきたいと思います。</p>
[adsense_top]
<h2 class="hdg-l2-01">MacでMAMPもXAMPPもを使わずに複数のローカルサーバを立てる手順</h2>
<p>以下の手順で設定を行っていきたいと思います。</p>
<ol class="list-number-01">
<li>Apacheをテスト起動</li>
<li>ユーザーディレクトリの作成</li>
<li>httpd.confを編集</li>
<li>ユーザ名.confの作成</li>
<li>httpd-vhost.confを編集</li>
<li>hostsファイルを編集</li>
<li>Apacheを再起動</li>
<li>ローカルサーバを開く</li>
</ol>
<p>今回、ホームディレクトリに「Sites」というフォルダを作って、さらにSites/直下に「hoge」「moge」ディレクトリを格納し、それぞれをローカルサーバとして設定してみたいと思います。</p>
<pre><code>users
└ユーザ名
 └Sites
  └hoge（これをローカルサーバに）
  └moge（これをローカルサーバに）</code></pre>
<h3 class="hdg-l3-01">&#9312;Apacheをテスト起動</h3>
<p>最初からMacにApacheは入っていますが、念のためターミナルで以下のコマンドを叩いて、Apacheが起動するか確認してみましょう。</p>
<pre><code>sudo apachectl start</code></pre>
<p>パスワードを求められたら、お使いのMacのパスワードを入力してください。</p>
<p>続いて、ブラウザでhttp://localhost/を開いてみてください。<strong>「It works!」</strong>が表示されていればOKです。</p>
<p><img src="/images/blog/2017/09/15_01_01.png" alt="" width="660" height="200"></p>
<h3 class="hdg-l3-01">&#9313;ユーザーディレクトリの作成</h3>
<p>ターミナルで以下のコマンドを叩いて、ユーザーディレクトリ「Sites」を作成しておきます。</p>
<pre><code>mkdir Sites</code></pre>
<h3 class="hdg-l3-01">&#9314;httpd.confの編集</h3>
<p>httpd.confは/etc/apache2/直下にありますが、Finderから階層を降りようとしても/etc/というフォルダは見つかりません。Finderのメニューから[フォルダへ移動]より以下のパスを入力して移動することでたどり着くことができます。</p>
<pre><code>/etc/apache2/</code></pre>
<h4 class="hdg-l4-01">SSIを有効にする</h3>
<p>デフォルトではSSIが無効になっているので、以下の変更を加えます。</p>
<pre><code>#AddType text/html .shtml
#AddOutputFilter INCLUDES .shtml</code></pre>
↓
<pre><code>AddType text/html .shtml
AddOutputFilter INCLUDES .shtml .html</code></pre>
<ul class="list-notice-01">
<li><span>※</span>ついでに.htmlの拡張子も有効化します</li>
</ul>
<h4 class="hdg-l4-01">PHPを有効にする</h3>
<p>phpを使わなければ別にやる必要は無いんですが、WordPressなどをローカルで動かしたい場合はphpが必要になるため、以下の変更を加えます。</p>
<pre><code>#LoadModule php5_module libexec/apache2/libphp5.so</code></pre>
↓
<pre><code>LoadModule php5_module libexec/apache2/libphp5.so</code></pre>
<h4 class="hdg-l4-01">ユーザーディレクトリを有効化</h3>
<p>以下のコメントアウトされている記述について、コメントアウトを外します。</p>
<pre><code>#LoadModule userdir_module libexec/apache2/mod_userdir.so</code></pre>
↓
<pre><code>LoadModule userdir_module libexec/apache2/mod_userdir.so</code></pre>
<pre><code>#Include /private/etc/apache2/extra/httpd-userdir.conf</code></pre>
↓
<pre><code>Include /private/etc/apache2/extra/httpd-userdir.conf</code></pre>
<p>この<strong>「ユーザーディレクトリの有効化」</strong>及び後述の<strong>「ユーザ名.confの作成」</strong>はWindows環境では不要な操作ですが、Macではデフォルトのルートディレクトリ「/Library/WebServer/Documents/」配下の権限はなんとroot権限になっており、ここに複数ローカルサーバ用のディレクトリを作っても<strong>「Fobidden」</strong>となってしまいます。そのためこのように、ユーザーディレクトリを使うよう設定をすることで、任意のディレクトリをローカルサーバとして扱うことが可能となります。</p>
[adsense_middle]
<h4 class="hdg-l4-01">バーチャルホストを有効化</h3>
<p>以下のコメントアウトされている記述について、コメントアウトを外します。</p>
<pre><code>#Include /private/etc/apache2/extra/httpd-vhosts.conf</code></pre>
↓
<pre><code>Include /private/etc/apache2/extra/httpd-vhosts.conf </code></pre>
<h3 class="hdg-l3-01">&#9315;ユーザ名.confの作成</h3>
<p>/etc/apache2/users/ユーザー名.confを作成し、以下の記述で保存します。</p>
<pre><code>&lt;Directory &quot;/Users/ユーザ名/Sites/&quot;&gt;
AllowOverride All
Options Indexes FollowSymLinks Multiviews
Require all granted
&lt;/Directory&gt;</code></pre>
<h3 class="hdg-l3-01">&#9316;httpd-vhost.confを編集</h3>
<p>バーチャルホストを設定します。/etc/apache2/extra/httpd-vhosts.confをエディタで開いて、一番下に以下の記述を加えます。</p>
<pre><code>#hoge
Listen 8082
&lt;VirtualHost *:8082&gt;
DocumentRoot &quot;/Users/ユーザ名/Sites/hoge&quot;
serverName hoge
&lt;/VirtualHost&gt;

#moge
Listen 8084
&lt;VirtualHost *:8084&gt;
DocumentRoot &quot;/Users/ユーザ名/Sites/moge&quot;
serverName moge
&lt;/VirtualHost&gt;</code></pre>
<h3 class="hdg-l3-01">&#9317;hostsファイルを編集</h3>
<p>先ほどhttpd-vhost.confで設定したサーバーネームにあわせて以下の記述を書き加えます。</p>
<pre><code>127.0.0.1 hoge
127.0.0.1 moge
::1	hoge
::1	moge</code></pre>
<h3 class="hdg-l3-01">&#9318;Apacheを再起動</h3>
<p>ターミナルで以下のコマンドを叩いて、Apacheを再起動します。</p>
<pre><code>sudo apachectl restart</code></pre>
<h3 class="hdg-l3-01">&#9319;ローカルサーバを開く</h3>
<p>hogeとmogeそれぞれ、以下のURLでローカルサーバが表示できれば成功です。</p>
<ul class="list-notice-01">
<li><span>※</span>確認用として、適当なindex.htmlを/Users/ユーザ名/Sites/hoge/直下と/Users/ユーザ名/Sites/moge/直下にそれぞれ格納しておきましょう</li>
</ul>
<pre><code>http://hoge:8082/index.html</code></pre>
<p><img src="/images/blog/2017/09/15_01_02.png" alt="" width="660" height="200"></p>
<pre><code>http://moge:8084/index.html</code></pre>
<p><img src="/images/blog/2017/09/15_01_03.png" alt="" width="660" height="200"></p>
<h2 class="hdg-l2-01">まとめ</h2>
<p>最初はMAMPやXAMPP for Macなどを使ってやろうかなとも思ったんですが、せっかくなのでMacの勉強も兼ねて、何のツールもいれずにローカルサーバを構築してみました。Windowsとは異なりユーザーディレクトリを作ってそれを許可してあげないとForbiddenになるところで引っかかったところが難儀でしたが、上記の手順にてローカルサーバを構築することで、これまでWindowsで構築していた環境と同じ感覚で作業を行うことができるようになりました。</p>
<p>Macでローカルサーバを複数構築する際はMAMPやXAMPPを使わなくても可能ですので、ぜひ本記事をご参考にしていただければ幸いです。</p>





<!--======================================ここまで記事用ソース======================================-->

<!--
<p><img src="/images/blog/2017/07/21_01_XX.jpg" alt="" width="660" height=""></p>
<h2 class="hdg-l2-01">まとめ</h2>
<p></p>
-->

</div><!--/#main-inner--></main></div><!--/#content--><p class="page_top"><a href="#">ページの先頭に戻る</a></p><footer><p>&copy;2016 Web屋の芝生DIY All rights reserved.</p></footer><script src="//code.jquery.com/jquery-2.2.4.min.js"></script><script src="/shared/js/init.js"></script><script></script></body></html>