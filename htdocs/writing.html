<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>執筆用 | ●●● | マイホームブログ | Web屋の芝生DIY</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/shared/css/basic.css" media="all"></head><body class="lyt-main-sub turf"><div id="content"><main><div id="main-inner"><p class="main-visual"><img src="/wp-content/uploads/thum-turf.jpg" alt=""></p>


<!--======================================ここから記事用ソース======================================-->

<p>jQueryでクリックイベントによる処理を行う際、click(function(){～のように記述することがよくあると思いますが、これがDOM生成した要素の場合うまく処理が効かないことがあります。そんな時、.on()メソッドを使うことで大体解決できますので、本記事ではこの.on()メソッドの使い方についてご紹介させていただきたいと思います。</p>
[adsense_top]
<h2 class="hdg-l2-01">サンプルコード</h2>
<h3 class="hdg-l3-01">イベントが実行できないパターン</h3>
<pre><code>$(function(){
  'use scrict';

  //DOM生成した要素にイベントが実行できない
  $('div.hoge').append('&lt;ul id=&quot;hoge-01&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;jsでページ読み込み時にDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
  $('div.hoge ul#hoge-01 li a').click(function(){
    $('div.hoge ul#hoge-01').after('&lt;ul id=&quot;hoge-02&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;クリックでDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
    return false;
  });
  $('div.hoge ul#hoge-02 li a').click(function(){
    alert('クリックしてもアラート表示されない');
    return false;
  });

});</code></pre>
<h2 class="hdg-l2-01">サンプルコード</h2>
<h3 class="hdg-l3-01">イベントが実行できるパターン</h3>
<pre><code>$(function(){
  'use scrict';

  //DOM生成した要素にイベントが実行できる
  $('div.moge').append('&lt;ul id=&quot;moge-01&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;jsでページ読み込み時にDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
  $('div.moge ul#moge-01 li a').click(function(){
    $('div.moge ul#moge-01').after('&lt;ul id=&quot;moge-02&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;クリックでDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
    return false;
  });
  $(document).on("click","div.moge ul#moge-02 li a",function(){
    alert('クリックするとアラート表示される');
    return false;
  });
  
});</code></pre>
<h3 class="hdg-l3-01">イベントが実行できるパターン（第二引数を省略）</h3>
<pre><code>$(function(){
  'use scrict';

  //DOM生成した要素にイベントが実行できる（第二引数を省略）
  $('div.fuga').append('&lt;ul id=&quot;fuga-01&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;jsでページ読み込み時にDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
  $('div.fuga ul#fuga-01 li a').click(function(){
    $('div.fuga ul#fuga-01').after('&lt;ul id=&quot;fuga-02&quot; class=&quot;list-link-01&quot;&gt;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;クリックでDOM生成されたリンク&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;');
    $('div.fuga ul#fuga-02 li a').on("click",function(){
      alert('クリックするとアラート表示される');
      return false;
    });
    return false;
  });

});</code></pre>
<ul class="list-notice-01">
<li><span>※</span><a href="https://jquery.com/" target="_blank" class="blank">jQuery</a>を読み込んでいる場合のスクリプトとなります</li>
</ul>
[adsense_middle]
<h2 class="hdg-l2-01">解説</h2>
<h3 class="hdg-l3-01">イベントが実行できないパターン</h3>
<p>.click()は、ページ読み込み時に存在する要素にイベントを付与します。ページ読み込み後、クリック等何かしらのアクションにより動的に生成された要素には有効ではありません。そのため、動的に追加した「$('div.hoge ul#hoge-02 li a')」をクリックしてもアラートは表示されない、ということです。return falseも機能しません。</p>
</p>
<h3 class="hdg-l3-01">イベントが実行できるパターン</h3>
<p>そこで、.on()メソッドの出番です。これを利用することで、ページ読み込み後に動的に追加された要素にもイベントが付与されます。.on()メソッドの第一引数にイベント名、第二引数にセレクタを指定することで動作します。ここでは$(document)により親要素に対するイベントハンドラを指定することで、子要素である「div.moge ul#moge-02 li a」をセレクタ指定しています。</p>
<h3 class="hdg-l3-01">イベントが実行できるパターン（第二引数を省略）</h3>
<p>.on()メソッドを使っている点は同じですが、こちらは第二引数を省略しかつセレクタに対して.on()を当てる方法です。これにより、対象の要素のみにイベントハンドラを追加することが可能です。サンプルコードでは、ページ読み込み時のリンク「$('div.fuga ul#fuga-01 li a').click(～」内に記述することで、DOM生成した要素にもイベントを付与しています。</p>
<h2 class="hdg-l2-01">デモ</h2>
<p>実際に動作を確認できるデモページも公開しておりますのであわせてご確認ください。</p>
<ul class="list-link-01">
<li><a href="/demo/180321_01/" target="_blank">DOM生成した要素に対してクリックなどのイベントを実行する方法</a></li>
</ul>
<h2 class="hdg-l2-01">まとめ</h2>
<p>昔のjQueryだとlive()とか使ってDOM生成した要素を弄んだ気がするんですが、今は.on()が汎用的に使えるのでとても便利ですね。</p>
<p>セレクタが合っているのにDOM要素を操作できない場合は、.on()メソッドを試してみてください。大体のパターンはこれによる解決すると思います。ご参考になれば幸いです。</p>




<!--======================================ここまで記事用ソース======================================-->

<!--
<p><img src="/images/blog/2018/02/XX_01_XX.jpg" alt="" width="660" height=""></p>
<h2 class="hdg-l2-01">まとめ</h2>
<p></p>
-->

</div><!--/#main-inner--></main></div><!--/#content--><p class="page_top"><a href="#">ページの先頭に戻る</a></p><footer><p>&copy;2016 Web屋の芝生DIY All rights reserved.</p></footer><script src="//code.jquery.com/jquery-2.2.4.min.js"></script><script src="/shared/js/init.js"></script><script></script></body></html>